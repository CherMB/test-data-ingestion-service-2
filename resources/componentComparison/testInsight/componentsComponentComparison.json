{
    "definition": {
        "id": "test-insights-components-compare",
        "title": "Components",
        "sub_title": "Comparison",
        "breadCrumbTitle": "{{.orgName}}",
        "post_process_function_name": "test components component comparison",
        "column_details": {
            "column1": "Name",
            "column2": "Count / Status"
        },
        "header_field": "totalValue",
        "compare_common_section_details": {
            "type": 2,
            "show_legends": false,
            "is_component_compare": true,
            "orientation": 0,
            "append_unit": " ",
            "tooltip_formatter": 1,
            "color_scheme": [
                {
                    "color0": "#ADFFD8",
                    "color1": "#17B268"
                },
                {
                    "color0": "#FFE6C1",
                    "color1": "#F2A414"
                }
            ],
            "light_color_scheme": [
                {
                    "color0": "#79CAA8",
                    "color1": "#0C9E61"
                },
                {
                    "color0": "#FFE6C1",
                    "color1": "#F2A414"
                }
            ]
        }
    },
    "queries": {
        "components": {
            "alias": "cb_test_suites",
            "query": {
                "_source": false,
                "size": 0,
                "query": {
                    "bool": {
                        "filter": [
                            {
                                "range": {
                                    "run_start_time": {
                                        "gte": "{{.startDate}}",
                                        "lte": "{{.endDate}}",
                                        "format": "yyyy-MM-dd HH:mm:ss",
                                        "time_zone": "{{.timeZone}}"
                                    }
                                }
                            }
                        ]
                    }
                },
                "aggs": {
                    "components": {
                        "scripted_metric": {
                            "init_script": "state.data_map=[:];",
                            "map_script": "def map = state.data_map;def key = doc.component_id.value;def v = ['component_id': doc.component_id.value];map.put(key, v);",
                            "combine_script": "return state.data_map;",
                            "reduce_script": "def tmpMap = [: ]; def resultMap = new HashMap(); for (response in states) { if (response != null) { for (key in response.keySet()) { def record = response.get(key); def compKey = record.component_id; tmpMap.put(compKey, record); } } } def components = []; for (component in tmpMap.keySet()) { components.add(component) } return components;"
                        }
                    }
                }
            }
        }
    }
}