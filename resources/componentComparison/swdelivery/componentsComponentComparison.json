{
    "definition": {
        "id": "components-compare",
        "title": "Components",
        "sub_title": "Comparison",
        "breadCrumbTitle": "{{.orgName}}",
        "post_process_function_name": "components component comparison",
        "column_details": {
            "column1": "Name",
            "column2": "Count / Status"
        },
        "header_field": "totalValue",
        "compare_common_section_details": {
            "type": 2,
            "show_legends": false,
            "is_component_compare": true,
            "orientation": 0,
            "append_unit": " ",
            "tooltip_formatter": 1,
            "color_scheme": [
                {
                    "color0": "#458CD1",
                    "color1": "#0D82F6"
                },
                {
                    "color0": "#8BA9B8",
                    "color1": "#5D7689"
                }
            ],
            "light_color_scheme": [
                {
                    "color0": "#35B1F9",
                    "color1": "#0781D2"
                },
                {
                    "color0": "#AEBEC5",
                    "color1": "#7591A2"
                }
            ]
        }
    },
    "queries": {
        "automationsChart": {
            "alias": "automation_metadata",
            "query": {
                "_source": false,
                "size": 0,
                "query": {
                    "bool": {
                        "filter": [
                            {
                                "range": {
                                    "last_active_time": {
                                        "gte": "{{.startDate}}",
                                        "lte": "{{.endDate}}",
                                        "format": "yyyy-MM-dd HH:mm:ss",
                                        "time_zone": "{{.timeZone}}"
                                    }
                                }
                            }
                        ]
                    }
                },
                "aggs": {
                    "components": {
                        "scripted_metric": {
                            "init_script": "state.data_map=[:];",
                            "map_script": "def map = state.data_map;def key = doc.component_id.value;def v = ['component_id': doc.component_id.value];map.put(key, v);",
                            "combine_script": "return state.data_map;",
                            "reduce_script": "def tmpMap = [: ]; def resultMap = new HashMap(); for (response in states) { if (response != null) { for (key in response.keySet()) { def record = response.get(key); def compKey = record.component_id; tmpMap.put(compKey, record); } } } def components = []; for (component in tmpMap.keySet()) { components.add(component) } return components;"
                        }
                    }
                }
            }
        }
    }
}